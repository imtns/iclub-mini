require('../../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages-activity/incentive/injection-info/sections/SectionConsumptionVoucher"],{"0f8b":function(t,e,n){"use strict";var r=n("6a73"),o=n.n(r);o.a},"46ea":function(t,e,n){"use strict";n.r(e);var r=n("f320"),o=n("64be4");for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("0f8b");var u,a=n("f0c5"),c=Object(a["a"])(o["default"],r["b"],r["c"],!1,null,"09a6e9cd",null,!1,r["a"],u);e["default"]=c.exports},"64be4":function(t,e,n){"use strict";n.r(e);var r=n("6a0c"),o=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(i);e["default"]=o.a},"6a0c":function(t,e,n){"use strict";(function(t){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=c(n("9733")),i=c(n("aa0c")),u=c(n("1ead")),a=n("28c0");function c(t){return t&&t.__esModule?t:{default:t}}function s(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */s=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},u=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(j){f=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof p?e:p,u=Object.create(i.prototype),a=new _(r||[]);return o(u,"_invoke",{value:C(t,n,a)}),u}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(j){return{type:"throw",arg:j}}}t.wrap=l;var d={};function p(){}function m(){}function y(){}var g={};f(g,u,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(O([])));b&&b!==e&&n.call(b,u)&&(g=b);var x=y.prototype=p.prototype=Object.create(g);function w(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function i(o,u,a,c){var s=h(t[o],t,u);if("throw"!==s.type){var f=s.arg,l=f.value;return l&&"object"==r(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){i("next",t,a,c)}),(function(t){i("throw",t,a,c)})):e.resolve(l).then((function(t){f.value=t,a(f)}),(function(t){return i("throw",t,a,c)}))}c(s.arg)}var u;o(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return u=u?u.then(r,r):r()}})}function C(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return q()}for(n.method=o,n.arg=i;;){var u=n.delegate;if(u){var a=T(u,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=h(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function T(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,T(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=h(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,d;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function O(t){if(t){var e=t[u];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:q}}function q(){return{value:void 0,done:!0}}return m.prototype=y,o(x,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:m,configurable:!0}),m.displayName=f(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,f(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(L.prototype),f(L.prototype,a,(function(){return this})),t.AsyncIterator=L,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var u=new L(l(e,n,r,o),i);return t.isGeneratorFunction(n)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},w(x),f(x,c,"Generator"),f(x,u,(function(){return this})),f(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=O,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return u.type="throw",u.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],u=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(a&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var u=i?i.completion:{};return u.type=t,u.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(u)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:O(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function f(t,e,n,r,o,i,u){try{var a=t[i](u),c=a.value}catch(s){return void n(s)}a.done?e(c):Promise.resolve(c).then(r,o)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function u(t){f(i,r,o,u,a,"next",t)}function a(t){f(i,r,o,u,a,"throw",t)}u(void 0)}))}}function h(t){return y(t)||m(t)||p(t)||d()}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(t,e){if(t){if("string"===typeof t)return g(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(t,e):void 0}}function m(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function y(t){if(Array.isArray(t))return g(t)}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var v=function(){n.e("pages-activity/incentive/injection-info/components/Pop").then(function(){return resolve(n("c86e"))}.bind(null,n)).catch(n.oe)},b=function(){n.e("pages-activity/incentive/injection-info/components/ProductDesc").then(function(){return resolve(n("1ea2"))}.bind(null,n)).catch(n.oe)},x={components:{Pop:v,ProductDesc:b},mixins:[(0,u.default)()],props:{info:{type:Object,default:function(){return{}}}},data:function(){return{productBatch:"",productSn:"",ccusName:"",outerCode:"",innerCode:"",snCodes:"",boxCodes:"",queryType:"",queryCount:"",queryRecordCode:"",loading:!1,name:"",type:"",tipTitle:"",tipSubTitle:"",firstQueryFlag:"",yanzhenCardFlag:"",prefix:"",phoneNumber:"",fanyingText:"",suffix:"",tipTitlePrefix:"",tipTitlePreText:"",tipTitlePuffix:"",examplePop:!1,scanResultPop:!1,hasSubmit:!1,deleteIndex:"",showDeleteScanCode:!1,form:{paymentProofList:[],serviceConfirmationList:[],institutionReceiptList:[],authenticityInfoList:[]},inputStyle:{borderColor:"transparent",backgroundColor:"#F5F7FB"}}},computed:{uniqueAuthenticityList:function(){var t=new Set;return this.form.authenticityInfoList.filter((function(e){return!t.has(e.code)&&(t.add(e.code),!0)}))}},watch:{form:{handler:function(t){this.hasSubmit&&this.checkForm()},deep:!0},examplePop:function(t){this.$emit("pop",t)},info:{handler:function(t){if(0!==Object.keys(t).length){var e=t.paymentProofList,n=t.serviceConfirmationList,r=t.institutionReceiptList,o=t.authenticityInfoList;this.form={paymentProofList:(e||[]).map((function(t){return{url:t}})),serviceConfirmationList:(n||[]).map((function(t){return{url:t}})),institutionReceiptList:(r||[]).map((function(t){return{url:t}})),authenticityInfoList:o||[]},console.error("🚀 ~ handler ~ form:",this.form)}},deep:!0,immediate:!0}},created:function(){this.setPicturesKey("paymentProofList"),this.setPicturesKey("serviceConfirmationList"),this.setPicturesKey("institutionReceiptList")},mounted:function(){var t=this;this.clearStorage(),setTimeout((function(){t.$refs.refForm.setRules(o.default.RuleConsumptionVoucher)}),500)},methods:{handleDeleteScanCode:function(){this.form.authenticityInfoList.splice(this.deleteIndex,1),this.showDeleteScanCode=!1},showDeletePop:function(t){this.deleteIndex=t,this.showDeleteScanCode=!0},getForm:function(){return{paymentProofList:this.form.paymentProofList.map((function(t){return t.url})),serviceConfirmationList:this.form.serviceConfirmationList.map((function(t){return t.url})),institutionReceiptList:this.form.institutionReceiptList.map((function(t){return t.url})),authenticityInfoList:this.form.authenticityInfoList}},getCodeAndQuery:function(){this.hasResult=!1,this.code=t.getStorageSync("scanResultJili"),console.error("🚀 ~ getCodeAndQuery ~ code:",this.code),this.code&&this.queryCodeDetail()},onScanButtonClicked:function(){if(this.isLogin){var e={pageSession:Math.random().toString(16).substring(2)+(new Date).getTime(),pageContent:JSON.stringify({id:"jili_scan_click",name:"用户激励-扫码验真-扫一扫点击"})};(0,i.default)({eventId:2,pageUrl:"pages-activity/incentive/index",referrerUrl:"",dataKeys:e});var n=this;t.scanCode({scanType:["qrCode","barCode","datamatrix","pdf417"],success:function(e){console.log("🚀 ~ 扫码回调 ~ res:",e);var r=e.result;if("DATA_MATRIX"===e.scanType){var o=r.indexOf("PG",r.indexOf("PG")+1);r=r.substring(o)}else if(r=r.replace(/\\n/g,"").replace(/\\/g,"").trim(),e.result.includes("http")){var i=function(t){var e=/[?&]code=([^&#]*)/,n=e.exec(t);return n?n[1]:null};r=i(e.result)}console.log("🚀 ~ success ~ code:",r),n.code=r,t.setStorageSync("scanResultJili",r),n.$nextTick((function(){n.getCodeAndQuery()}))},fail:function(t){console.error("扫码识别失败",t),"scanCode:fail cancel"!==t.errMsg&&n.$refs.toast.show({message:"扫码识别失败！"})}})}else this.goLogin()},toTrouch:function(){t.makePhoneCall({phoneNumber:"400-001-6195",success:function(t){console.log("调用成功!")},fail:function(t){console.log("调用失败!")}})},clearStorage:function(){t.removeStorage({key:"scanResultJili"})},queryCodeDetail:function(){var e=this;if(!this.loading){console.error("this.code",this.code),this.queryType=null,this.resetInfo(),t.showLoading({title:"查询中..."});var n={pageSession:Math.random().toString(16).substring(2)+(new Date).getTime(),pageContent:JSON.stringify({id:"hihi_scan_search_click",name:"爱+激励-扫码验真-查询按钮点击"})};this.loading=!0;var r=this.code.replace(/\s+/g,"").trim();(0,a.apiGetScanCode)({code:r,methodName:"queryCodeDetail"}).then((function(t){if(200===t.code){var n=t.data;if(console.log("res,",n),e.loading=!1,null===n.queryStatus&&null===n.queryType)return void e.$refs.toast.show({message:n.toast});e.hasResult=!0,e.tempCode=e.code,e.type=n.type,e.name=n.bf_product_name||"",e.productBatch=n.bf_product_batch,e.ccusName=n.ccusName,e.productSn=n.bf_product_sn,e.boxCodes=n.boxCodes,e.snCodes=n.snCodes,"1"===n.queryType||"2"===n.queryType?e.outerCode=n.bf_product_box_code:"3"===n.queryType?e.outerCode=n.bf_product_package_code:e.outerCode="",e.queryType=n.queryType,e.queryCount=n.queryCount,e.queryRecordCode=n.queryRecordCode,e.innerCode=n.snCodes,e.tipTitle=n.tipTitle,e.tipSubTitle=n.tipSubTitle,e.firstQueryFlag=n.firstQueryFlag,e.yanzhenCardFlag=n.yanzhenCardFlag;var r=["产品序列号有误，","产品序列号不存在，"],o=e.processErrorTitle(n.tipTitle,r),i=o.prefix,u=o.errorMessage,a=o.suffix;i||u||a?(console.log(i),e.tipTitlePrefix=i,e.tipTitlePreText=u,e.tipTitlePuffix=a):(e.tipTitlePrefix=n.tipTitle,e.tipTitlePreText="",e.tipTitlePuffix="");var c="400 0016 195",s="反映问题，",f=n.tipSubTitle.indexOf(c),l=n.tipSubTitle.indexOf(s);-1!==f?(e.prefix=n.tipSubTitle.substring(0,f).trim(),e.phoneNumber=c,-1!==l?(e.fanyingText=s,e.suffix=n.tipSubTitle.substring(l+s.length).trim()):(e.fanyingText="",e.suffix=n.tipSubTitle.substring(f+c.length).trim())):(e.prefix=n.tipSubTitle,e.phoneNumber="",e.fanyingText="",e.suffix=""),"1"===n.queryStatus&&0===e.form.authenticityInfoList.filter((function(t){return t.code===e.code})).length&&(e.form.authenticityInfoList=[{code:e.code,queryRecordCode:e.queryRecordCode}].concat(h(e.form.authenticityInfoList))),e.scanResultPop=!0}else e.$refs.toast.show({message:t.message})})).catch((function(n){e.$refs.toast.show({message:n.message}),t.hideLoading(),e.loading=!1})).finally((function(){t.hideLoading(),setTimeout((function(){(0,i.default)({eventId:2,pageUrl:"pages-activity/incentive/injection-info/index",referrerUrl:"",dataKeys:n})}),100)}))}},processErrorTitle:function(t,e){var n,r,o;return e.some((function(e){var i=t.indexOf(e);return-1!==i&&(n=t.substring(0,i).trim(),r=e,o=t.substring(i+e.length).trim(),!0)})),{prefix:n,errorMessage:r,suffix:o}},resetInfo:function(){this.type="",this.name="",this.productBatch="",this.ccusName="",this.productSn="",this.tipTitle="",this.tipSubTitle=""},checkForm:function(t){var e=this;return l(s().mark((function n(){var r,o,i;return s().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t&&(e.hasSubmit=!0),r=e.form.paymentProofList.filter((function(t){return"uploading"===t.status})).length>0,o=e.form.serviceConfirmationList.filter((function(t){return"uploading"===t.status})).length>0,i=e.form.institutionReceiptList.filter((function(t){return"uploading"===t.status})).length>0,!(r||o||i)){n.next=7;break}return e.$refs.toast.show({message:"请等待图片上传完成"}),n.abrupt("return",!1);case 7:return n.prev=7,n.next=10,e.$refs.refForm.validate();case 10:return n.abrupt("return",!0);case 13:return n.prev=13,n.t0=n["catch"](7),n.abrupt("return",!1);case 16:case"end":return n.stop()}}),n,null,[[7,13]])})))()}}};e.default=x}).call(this,n("543d")["default"])},"6a73":function(t,e,n){},f320:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return r}));var r={xSection:function(){return n.e("components/x/section").then(n.bind(null,"8af3"))},uniForms:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(n.bind(null,"2cf2"))},uniFormsItem:function(){return n.e("uni_modules/uni-forms/components/uni-forms-item/uni-forms-item").then(n.bind(null,"11e2"))},xUploader:function(){return Promise.all([n.e("common/vendor"),n.e("components/x/uploader")]).then(n.bind(null,"3bc4"))},xPop:function(){return n.e("components/x/pop").then(n.bind(null,"3bb2"))},xToast:function(){return n.e("components/x/toast").then(n.bind(null,"f8a6"))}},o=function(){var t=this,e=t.$createElement,n=(t._self._c,Number(t.queryCount)>5||"N"===t.queryCount),r="-1"!==t.queryType&&Number(t.queryCount)<=5,o=Number(t.queryCount)>5||"N"===t.queryCount,i=o?t.prefix.trim():null,u=o?t.suffix.trim():null;t._isMounted||(t.e0=function(e){t.examplePop=!0}),t.$mp.data=Object.assign({},{$root:{m0:n,m1:r,m2:o,g0:i,g1:u}})},i=[]}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages-activity/incentive/injection-info/sections/SectionConsumptionVoucher-create-component',
    {
        'pages-activity/incentive/injection-info/sections/SectionConsumptionVoucher-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("46ea"))
        })
    },
    [['pages-activity/incentive/injection-info/sections/SectionConsumptionVoucher-create-component']]
]);
