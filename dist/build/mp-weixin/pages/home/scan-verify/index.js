(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/scan-verify/index"],{"226e":function(e,t,n){"use strict";n.r(t);var i=n("4ff6"),r=n("3254");for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n("28e1");var s,u=n("f0c5"),a=Object(u["a"])(r["default"],i["b"],i["c"],!1,null,"0b64e596",null,!1,i["a"],s);t["default"]=a.exports},"28e1":function(e,t,n){"use strict";var i=n("5d9c"),r=n.n(i);r.a},3254:function(e,t,n){"use strict";n.r(t);var i=n("e45d"),r=n.n(i);for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);t["default"]=r.a},"4ff6":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}));var i={ikCustomHeader:function(){return Promise.all([n.e("common/vendor"),n.e("components/common/custom-header")]).then(n.bind(null,"3e50"))},xToast:function(){return n.e("components/x/toast").then(n.bind(null,"f8a6"))}},r=function(){var e=this,t=e.$createElement,n=(e._self._c,e.hasResult?"-1"!==e.queryType&&Number(e.queryCount)<=5:null),i=e.hasResult?-1===Number(e.queryType)||Number(e.queryCount)>5:null,r=e.hasResult&&i?e.prefix.trim():null,o=e.hasResult&&i?e.suffix.trim():null;e.$mp.data=Object.assign({},{$root:{m0:n,m1:i,g0:r,g1:o}})},o=[]},"5d9c":function(e,t,n){},e45d:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(n("aa0c")),r=n("a789"),o=n("26cb");function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){n.e("pages/home/scan-verify/components/ProductDesc").then(function(){return resolve(n("eaf8"))}.bind(null,n)).catch(n.oe)},f={name:"AuthQuery",components:{ProductDesc:l},data:function(){return{code:e.getStorageSync("scanResult")||"",hasResult:!1,tempCode:"",name:"",productBatch:"",productSn:"",ccusName:"",outerCode:"",innerCode:"",snCodes:"",boxCodes:"",queryType:"",queryCount:"",loading:!1,type:"",tipTitle:"",tipSubTitle:"",firstQueryFlag:"",yanzhenCardFlag:"",prefix:"",phoneNumber:"",fanyingText:"",suffix:"",tipTitlePrefix:"",tipTitlePreText:"",tipTitlePuffix:""}},computed:a({},(0,o.mapState)(["isSpecialEventRunning","isLogin"])),onShow:function(){this.getCodeAndQuery()},methods:a(a({},(0,o.mapActions)(["getComment","setIntegral"])),{},{toTrouch:function(){e.makePhoneCall({phoneNumber:"400-0016-195",success:function(e){console.log("调用成功!")},fail:function(e){console.log("调用失败!")}})},onCheckLogin:function(){this.isLogin||this.goLogin()},handleInput:function(e){var t=e.detail,n=t.value,i=t.keyCode;if(32===i)return this.code;n=n.replace(/\s+/g,"").trim(),this.code=n},getCodeAndQuery:function(){this.hasResult=!1,this.code=e.getStorageSync("scanResult"),this.code&&this.queryCodeDetail(),this.clearStorage()},clearStorage:function(){e.removeStorage({key:"scanResult"})},handleRecordClick:function(){this.isLogin?e.navigateTo({url:"/pages/mine/scan-verify/record"}):this.goLogin()},clearInput:function(){this.code="",this.hasResult=!1},queryCodeDetail:function(){var t=this;if(console.log("11111"),this.isLogin){if(!this.loading)if(this.code){this.queryType=null,this.resetInfo(),e.showLoading({title:"查询中..."});var n={pageSession:Math.random().toString(16).substring(2)+(new Date).getTime(),pageContent:JSON.stringify({id:"hihi_scan_search_click",name:"首页-扫码验真-查询按钮点击"})};(0,i.default)({eventId:2,pageUrl:"pages/home/index",referrerUrl:"",dataKeys:n}),this.loading=!0;var o=this.code.replace(/\s+/g,"").trim();(0,r.queryAuthenticityInfo)({code:o,methodName:"queryCodeDetail"}).then((function(n){t.loading=!1,e.hideLoading(),t.hasResult=!0,t.tempCode=t.code,t.type=n.type,t.name=n.bf_product_name||"",t.productBatch=n.bf_product_batch,t.ccusName=n.ccusName,t.productSn=n.bf_product_sn,t.boxCodes=n.boxCodes,t.snCodes=n.snCodes,"1"===n.queryType||"2"===n.queryType?t.outerCode=n.bf_product_box_code:"3"===n.queryType?t.outerCode=n.bf_product_package_code:t.outerCode="",t.queryType=n.queryType,t.queryCount=n.queryCount,t.innerCode=n.snCodes,t.tipTitle=n.tipTitle,t.tipSubTitle=n.tipSubTitle,t.firstQueryFlag=n.firstQueryFlag,t.yanzhenCardFlag=n.yanzhenCardFlag;var i=["产品序列号有误，","产品序列号不存在，"],r=t.processErrorTitle(n.tipTitle,i),o=r.prefix,s=r.errorMessage,u=r.suffix;o||s||u?(console.log(o),t.tipTitlePrefix=o,t.tipTitlePreText=s,t.tipTitlePuffix=u):(t.tipTitlePrefix=n.tipTitle,t.tipTitlePreText="",t.tipTitlePuffix="");var a="400 0016 195",c="反映问题，",l=n.tipSubTitle.indexOf(a),f=n.tipSubTitle.indexOf(c);-1!==l?(t.prefix=n.tipSubTitle.substring(0,l).trim(),t.phoneNumber=a,-1!==f?(t.fanyingText=c,t.suffix=n.tipSubTitle.substring(f+c.length).trim()):(t.fanyingText="",t.suffix=n.tipSubTitle.substring(l+a.length).trim())):(t.prefix=n.tipSubTitle,t.phoneNumber="",t.fanyingText="",t.suffix="")})).catch((function(n){t.loading=!1,e.hideLoading()})).finally((function(){t.loading=!1}))}else this.$refs.toast.show({message:"请输入正确的产品序列号"})}else this.goLogin()},processErrorTitle:function(e,t){var n,i,r;return t.some((function(t){var o=e.indexOf(t);return-1!==o&&(n=e.substring(0,o).trim(),i=t,r=e.substring(o+t.length).trim(),!0)})),{prefix:n,errorMessage:i,suffix:r}},resetInfo:function(){this.type="",this.name="",this.productBatch="",this.ccusName="",this.productSn="",this.tipTitle="",this.tipSubTitle=""},onScanButtonClicked:function(){if(this.isLogin){var t={pageSession:Math.random().toString(16).substring(2)+(new Date).getTime(),pageContent:JSON.stringify({id:"hihi_scan_click",name:"首页-扫码验真-扫一扫点击"})};(0,i.default)({eventId:2,pageUrl:"pages/home/index",referrerUrl:"",dataKeys:t});var n=this;e.scanCode({scanType:["qrCode","barCode","datamatrix","pdf417"],onlyFromCamera:!0,success:function(t){console.log("🚀 ~ 扫码回调 ~ res:",t);var i=t.result;if("DATA_MATRIX"===t.scanType){var r=i.indexOf("PG",i.indexOf("PG")+1);i=i.substring(r)}else if(i=i.replace(/\\n/g,"").replace(/\\/g,"").trim(),t.result.includes("http")){var o=function(e){var t=/[?&]code=([^&#]*)/,n=t.exec(e);return n?n[1]:null};i=o(t.result)}console.log("🚀 ~ success ~ code:",i),n.code=i,e.setStorageSync("scanResult",i),n.$nextTick((function(){n.getCodeAndQuery()}))},fail:function(e){console.error("扫码识别失败",e),"scanCode:fail cancel"!==e.errMsg&&n.$refs.toast.show({message:"扫码识别失败！"})}})}else this.goLogin()}})};t.default=f}).call(this,n("543d")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/home/scan-verify/index-create-component',
    {
        'pages/home/scan-verify/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("226e"))
        })
    },
    [['pages/home/scan-verify/index-create-component']]
]);
