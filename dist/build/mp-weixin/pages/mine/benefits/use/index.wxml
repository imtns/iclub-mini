<page-meta page-style="{{popShow?'overflow: hidden;':''}}" class="data-v-5e189f42"></page-meta><x-wrapper vue-id="d6c65f88-1" footer="{{true}}" pb="{{240}}" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['default']}}"><view class="container _div data-v-5e189f42"><x-section vue-id="{{('d6c65f88-2')+','+('d6c65f88-1')}}" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['title','form']}}"><x-title vue-id="{{('d6c65f88-3')+','+('d6c65f88-2')}}" title="基本信息" class="data-v-5e189f42" slot="title" bind:__l="__l"></x-title><view class="form-wrapper data-v-5e189f42" slot="form"><uni-forms vue-id="{{('d6c65f88-4')+','+('d6c65f88-2')}}" label-width="{{200}}" label-position="top" model-value="{{form}}" data-ref="refForm1" class="data-v-5e189f42 vue-ref" bind:__l="__l" vue-slots="{{['default']}}"><uni-forms-item vue-id="{{('d6c65f88-5')+','+('d6c65f88-4')}}" label="使用门店" name="storeCode" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['default']}}"><x-input vue-id="{{('d6c65f88-6')+','+('d6c65f88-5')}}" disabled="{{true}}" readonly="{{true}}" value="{{form.storeName}}" placeholder="请选择门店" data-event-opts="{{[['^click',[['onStorePick']]]]}}" bind:click="__e" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['right']}}"><uni-icons style="position:relative;right:20rpx;" vue-id="{{('d6c65f88-7')+','+('d6c65f88-6')}}" type="forward" color="#8E9296" class="data-v-5e189f42" slot="right" bind:__l="__l"></uni-icons></x-input></uni-forms-item><uni-forms-item vue-id="{{('d6c65f88-8')+','+('d6c65f88-4')}}" label="治疗部位" name="{{$root.g0?'treatSiteName':'treatSiteCode'}}" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['default']}}"><x-input vue-id="{{('d6c65f88-9')+','+('d6c65f88-8')}}" disabled="{{true}}" readonly="{{true}}" maxlength="50" value="{{treatSiteNames}}" placeholder="请选择治疗部位" data-event-opts="{{[['^click',[['onTreatsiteClick']]]]}}" bind:click="__e" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['right']}}"><uni-icons style="position:relative;right:20rpx;" vue-id="{{('d6c65f88-10')+','+('d6c65f88-9')}}" type="forward" color="#8E9296" class="data-v-5e189f42" slot="right" bind:__l="__l"></uni-icons></x-input><block wx:if="{{$root.g1}}"><view style="margin-top:12rpx;" class="data-v-5e189f42"><x-input bind:input="__e" vue-id="{{('d6c65f88-11')+','+('d6c65f88-8')}}" maxlength="15" placeholder="请输入其他治疗部位" value="{{form.treatSiteName}}" data-event-opts="{{[['^input',[['__set_model',['$0','treatSiteName','$event',[]],['form']]]]]}}" class="data-v-5e189f42" bind:__l="__l"></x-input></view></block></uni-forms-item></uni-forms></view></x-section><x-section vue-id="{{('d6c65f88-12')+','+('d6c65f88-1')}}" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['title','form','footer']}}"><x-title vue-id="{{('d6c65f88-13')+','+('d6c65f88-12')}}" title="产品信息" class="data-v-5e189f42" slot="title" bind:__l="__l"></x-title><view class="data-v-5e189f42" slot="form"><block wx:for="{{form.products}}" wx:for-item="product" wx:for-index="idx" wx:key="idx"><uni-forms vue-id="{{('d6c65f88-14-'+idx)+','+('d6c65f88-12')}}" label-width="{{200}}" label-position="top" model-value="{{form.products[idx]}}" data-ref="subformRef" class="data-v-5e189f42 vue-ref-in-for" bind:__l="__l" vue-slots="{{['default']}}"><view class="form-wrapper data-v-5e189f42" style="margin-bottom:32rpx;"><uni-forms-item vue-id="{{('d6c65f88-15-'+idx)+','+('d6c65f88-14-'+idx)}}" label="使用产品" name="welfareProductCode" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['default']}}"><x-picker bind:input="__e" vue-id="{{('d6c65f88-16-'+idx)+','+('d6c65f88-15-'+idx)}}" placeholder="请选择使用产品" is-picker="{{true}}" picker-key="welfareProductName" picker-value="objectCode" origin-range="{{picker.productList}}" range="{{productPickerList}}" value="{{product.welfareProductCode}}" data-event-opts="{{[['^input',[['__set_model',['$0','welfareProductCode','$event',[]],[[['form.products','',idx]]]]]]]}}" class="data-v-5e189f42" bind:__l="__l"></x-picker></uni-forms-item><uni-forms-item vue-id="{{('d6c65f88-17-'+idx)+','+('d6c65f88-14-'+idx)}}" label="使用数量（支）" name="quantity" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['default']}}"><x-input vue-id="{{('d6c65f88-18-'+idx)+','+('d6c65f88-17-'+idx)}}" max="{{50}}" type="number" placeholder="请输入使用数量" value="{{product.quantity}}" data-event-opts="{{[['^blur',[['onQuantityBlur',[idx]]]],['^input',[['__set_model',['$0','quantity','$event',[]],[[['form.products','',idx]]]]]]]}}" bind:blur="__e" bind:input="__e" class="data-v-5e189f42" bind:__l="__l"></x-input></uni-forms-item><uni-forms-item vue-id="{{('d6c65f88-19-'+idx)+','+('d6c65f88-14-'+idx)}}" label="产品条码" name="productBarcodes" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['default']}}"><x-uploader vue-id="{{('d6c65f88-20-'+idx)+','+('d6c65f88-19-'+idx)}}" multiple="{{true}}" max-size="{{maxSize}}" disabled="{{product.quantity<1}}" max-count="{{product.quantity}}" filelist="{{product.productBarcodes}}" data-event-opts="{{[['^delete',[['e0']]],['^afterread',[['e1']]],['^oversize',[['oversize']]],['^disabled',[['onUploadDisabledClick']]]]}}" data-event-params="{{({idx,idx})}}" bind:delete="__e" bind:afterread="__e" bind:oversize="__e" bind:disabled="__e" class="data-v-5e189f42" bind:__l="__l"></x-uploader></uni-forms-item><block wx:if="{{idx>0}}"><view data-event-opts="{{[['tap',[['e2',['$event']]]]]}}" data-event-params="{{({idx})}}" class="btn-delete data-v-5e189f42" bindtap="__e"><uni-icons style="margin-right:4rpx;" vue-id="{{('d6c65f88-21-'+idx)+','+('d6c65f88-14-'+idx)}}" type="trash" color="#F4334A" size="20" class="data-v-5e189f42" bind:__l="__l"></uni-icons>删除产品</view></block></view></uni-forms></block></view><view data-event-opts="{{[['tap',[['onAddProduct',['$event']]]]]}}" class="add-product data-v-5e189f42" bindtap="__e" slot="footer"></view></x-section><x-section vue-id="{{('d6c65f88-22')+','+('d6c65f88-1')}}" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['title','form']}}"><x-title vue-id="{{('d6c65f88-23')+','+('d6c65f88-22')}}" title="验证" class="data-v-5e189f42" slot="title" bind:__l="__l"></x-title><view class="form-wrapper data-v-5e189f42" slot="form"><uni-forms vue-id="{{('d6c65f88-24')+','+('d6c65f88-22')}}" label-width="{{200}}" label-position="top" model-value="{{form}}" data-ref="refForm2" class="data-v-5e189f42 vue-ref" bind:__l="__l" vue-slots="{{['default']}}"><uni-forms-item vue-id="{{('d6c65f88-25')+','+('d6c65f88-24')}}" label="核销金额（元）" name="consumePrice" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['default']}}"><x-input bind:input="__e" vue-id="{{('d6c65f88-26')+','+('d6c65f88-25')}}" disabled="{{true}}" placeholder=" " value="{{form.consumePrice}}" data-event-opts="{{[['^input',[['__set_model',['$0','consumePrice','$event',[]],['form']]]]]}}" class="data-v-5e189f42" bind:__l="__l"></x-input></uni-forms-item><uni-forms-item class="verifyCode data-v-5e189f42" vue-id="{{('d6c65f88-27')+','+('d6c65f88-24')}}" label="安全验证" name="verifyCode" bind:__l="__l" vue-slots="{{['default']}}"><view style="position:relative;top:-14rpx;margin-bottom:10rpx;font-size:26rpx;" class="data-v-5e189f42">{{$root.m0}}</view><x-input bind:input="__e" vue-id="{{('d6c65f88-28')+','+('d6c65f88-27')}}" cursor-spacing="{{60}}" clearable="{{false}}" type="number" placeholder="请输入验证码" value="{{form.verifyCode}}" data-event-opts="{{[['^input',[['__set_model',['$0','verifyCode','$event',[]],['form']]]]]}}" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['right']}}"><text data-event-opts="{{[['tap',[['startCountdown',['$event']]]]]}}" class="count data-v-5e189f42" bindtap="__e" slot="right">{{buttonText}}</text></x-input></uni-forms-item></uni-forms></view></x-section><x-footer vue-id="{{('d6c65f88-29')+','+('d6c65f88-1')}}" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['default']}}"><x-btn vue-id="{{('d6c65f88-30')+','+('d6c65f88-29')}}" loading="{{btnLoading}}" data-event-opts="{{[['^click',[['onConfirm']]]]}}" bind:click="__e" class="data-v-5e189f42" bind:__l="__l" vue-slots="{{['default']}}">立即使用</x-btn></x-footer><uni-popup vue-id="{{('d6c65f88-31')+','+('d6c65f88-1')}}" type="center" mask-click="{{false}}" data-ref="resultPop" class="data-v-5e189f42 vue-ref" bind:__l="__l" vue-slots="{{['default']}}"><view class="result-wrapper data-v-5e189f42"><image class="bg data-v-5e189f42" src="https://imeikud.oss-cn-beijing.aliyuncs.com/pcUploads/1701339209121/result-bg.png"></image><view class="buttons data-v-5e189f42"><view data-event-opts="{{[['tap',[['goResult',['detail']]]]]}}" class="btn detail data-v-5e189f42" bindtap="__e"></view><view data-event-opts="{{[['tap',[['goResult']]]]}}" class="btn back data-v-5e189f42" bindtap="__e"></view></view></view></uni-popup><uni-popup vue-id="{{('d6c65f88-32')+','+('d6c65f88-1')}}" type="bottom" background-color="#fff" data-ref="popup" data-event-opts="{{[['^change',[['e3']]]]}}" bind:change="__e" class="data-v-5e189f42 vue-ref" bind:__l="__l" vue-slots="{{['default']}}"><view class="popup-wrapper data-v-5e189f42"><view class="header data-v-5e189f42"><text class="title data-v-5e189f42">选择治疗部位</text><uni-icons vue-id="{{('d6c65f88-33')+','+('d6c65f88-32')}}" type="closeempty" color="#8E9296" data-event-opts="{{[['^click',[['e4']]]]}}" bind:click="__e" class="data-v-5e189f42" bind:__l="__l"></uni-icons></view><treat-site-list bind:confirm="__e" vue-id="{{('d6c65f88-34')+','+('d6c65f88-32')}}" data-ref="tsl" data-event-opts="{{[['^confirm',[['onTreatsiteConfirm']]]]}}" class="data-v-5e189f42 vue-ref" bind:__l="__l"></treat-site-list></view></uni-popup></view><global-captcha vue-id="{{('d6c65f88-35')+','+('d6c65f88-1')}}" data-ref="captcha" class="data-v-5e189f42 vue-ref" bind:__l="__l"></global-captcha><global-privacy-popup vue-id="{{('d6c65f88-36')+','+('d6c65f88-1')}}" data-ref="privacyComponent" class="data-v-5e189f42 vue-ref" bind:__l="__l"></global-privacy-popup><x-toast vue-id="{{('d6c65f88-37')+','+('d6c65f88-1')}}" data-ref="toast" class="data-v-5e189f42 vue-ref" bind:__l="__l"></x-toast></x-wrapper>